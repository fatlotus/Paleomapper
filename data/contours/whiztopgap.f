        CHARACTER*80 NAME
        CHARACTER*80 NAM1
	CHARACTER*3 AREA,TYP1
	CHARACTER*2 TYPE
        CHARACTER*1 TAB
        TAB=CHAR(9)
	AREA='99X'
	ICNT=0
	TYPE*, 'THIS PROGRAM CONVERTS WHIZATLAS FILES' 
	TYPE*, '  INTO PGAP FORMAT FILES'
        WRITE(6,*) 'ENTER THE NAME OF THE FILE TO BE CONVERTED'
        READ(5,2) NAME
	OPEN(UNIT=2,NAME=NAME,READONLY,ERR=99)
2       FORMAT(A80)
        TYPE*, 'ENTER NAME OF CONVERTED FILE'
        READ(5,2) NAM1
        OPEN(UNIT=3,NAME=NAM1)
4	CONTINUE
        TYPE*, 'ENTER LINE TYPE BATHYMETRY=BA TOPOGRAPHY=TO'
        READ(5,440) TYPE
        TYPE*, 'ENTER LINE ELEVATION RELATIVE TO SEA LEVEL'
        READ(5,*) LTYP
        TYPE*, 'ENTER OLD THEN YOUNG AGE OF LINE'
        READ(5,*) T1,T2
	write (6,*) T1,T2
440	format(a2)
	IF (TYPE.EQ.'BA') then
	IF (LTYP.EQ.0) ICOL=3
	IF (LTYP.EQ.50) ICOL=2
	IF (LTYP.EQ.100) ICOL=2
	IF (LTYP.EQ.200) ICOL=2
	IF (LTYP.EQ.300) ICOL=2
	IF (LTYP.EQ.400) ICOL=2
	IF (LTYP.EQ.500) ICOL=2
	IF (LTYP.EQ.600) ICOL=2
	IF (LTYP.EQ.700) ICOL=2
	IF (LTYP.EQ.800) ICOL=2
	IF (LTYP.EQ.900) ICOL=2
	IF (LTYP.EQ.1000) ICOL=2
	IF (LTYP.EQ.1500) ICOL=2
	IF (LTYP.EQ.2000) ICOL=1
	IF (LTYP.EQ.2500) ICOL=1
	IF (LTYP.EQ.3000) ICOL=1
	IF (LTYP.EQ.3500) ICOL=1
	IF (LTYP.EQ.4000) ICOL=1
	IF (LTYP.EQ.4500) ICOL=1
	IF (LTYP.EQ.5000) ICOL=1
	IF (LTYP.EQ.5500) ICOL=1
	IF (LTYP.EQ.6000) ICOL=1
	IF (LTYP.EQ.7000) ICOL=1
	IF (LTYP.EQ.8000) ICOL=1
	IF (LTYP.EQ.9000) ICOL=1
	go to 77	
	endif
	IF (TYPE.EQ.'TO') then
	IF (LTYP.EQ.0) ICOL=3
	IF (LTYP.EQ.50) ICOL=4
	IF (LTYP.EQ.100) ICOL=5
	IF (LTYP.EQ.200) ICOL=5
	IF (LTYP.EQ.300) ICOL=5
	IF (LTYP.EQ.400) ICOL=5
	IF (LTYP.EQ.500) ICOL=5
	IF (LTYP.EQ.600) ICOL=5
	IF (LTYP.EQ.700) ICOL=5
	IF (LTYP.EQ.800) ICOL=5
	IF (LTYP.EQ.900) ICOL=5
	IF (LTYP.EQ.1000) ICOL=6
	IF (LTYP.EQ.1500) ICOL=6
	IF (LTYP.EQ.2000) ICOL=6
	IF (LTYP.EQ.2500) ICOL=6
	IF (LTYP.EQ.3000) ICOL=6
	IF (LTYP.EQ.3500) ICOL=6
	IF (LTYP.EQ.4000) ICOL=7
	IF (LTYP.EQ.4500) ICOL=7
	IF (LTYP.EQ.5000) ICOL=7
	IF (LTYP.EQ.5500) ICOL=7
	IF (LTYP.EQ.6000) ICOL=7
	IF (LTYP.EQ.7000) ICOL=7
	IF (LTYP.EQ.8000) ICOL=7
	IF (LTYP.EQ.9000) ICOL=7
	endif
77	continue
        READ(2,*,END=50)
40	CONTINUE
	ICNT=ICNT+1
        READ(2,*,END=50)NCNT,MCNT,ID
C441	format(1x,i5,1x,i5,1x,i3)
C441	format(i5,1x,i5,1x,i3)
        WRITE(6,*)NCNT,ID
	IF(NCNT.EQ.0) GO TO 50
       IF (TYPE.EQ.'BA') LTYP=-LTYP  
        WRITE(3,445)AREA,ICNT,ID,NCNT,T1,T2,TYPE,LTYP,ICOL
C        WRITE(3,445)IPTS,TAB,IPTS,TAB,NAM1
445	FORMAT(1X,1A3,1I4,1X,1i3,1x,i4,2(1x,f6.2),1X,1A2,1X,1i5,
     *1X,1I1)
41      CONTINUE
CCCCCC
CCCCCC  DATA INTERPRETED
CCCCCC
	DO 42 I=1,NCNT
	READ(2,*) ALAT,ALONG
	IF (I.EQ.1) IPEN=3
	WRITE(3,1006)ALAT,ALONG,IPEN
	IPEN=2
42	CONTINUE
	ALAT=99.00
	ALONG=0.00
	IPEN=3
	WRITE(3,1006)ALAT,ALONG,IPEN
	GO TO 40
43	CONTINUE
	GO TO 50
99      TYPE*, 'ERROR DURING READ'
50      TYPE*, 'PROGRAM ENDED'
1006	FORMAT(F9.4,1X,F9.4,1X,I2)
        STOP
         END

