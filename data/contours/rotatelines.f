	CHARACTER*90 NAME
	CHARACTER*1 TAB
	COMMON/BLOCK1/ROTLAT,ROTLO,ROTAN
	TAB=CHAR(9)
10	CONTINUE
20	TYPE*, 'ENTER NAME OF FILE OF POINTS'
	READ(5,1)NAME
1	FORMAT(1A90)
	OPEN(UNIT=2,NAME=NAME,TYPE='OLD')
	TYPE*, 'ENTER NAME OF OUTPUT FILE'	
	READ(5,1)NAME
	OPEN(UNIT=4,NAME=NAME)
11	CONTINUE
	WRITE (6,*)'type the ROTLAT,ROTLO,ROTAN'
	READ(5,*)ROTLAT,ROTLO,ROTAN
22	CONTINUE
        READ(2,445,END=30)AREA,ICNT,ID,NCNT,T1,T2,TYPE,LTYP,ICOL
        WRITE(6,445)AREA,ICNT,ID,NCNT,T1,T2,TYPE,LTYP,ICOL
        WRITE(4,445)AREA,ICNT,ID,NCNT,T1,T2,TYPE,LTYP,ICOL
445	FORMAT(1X,1A3,1I4,1X,1i3,1x,i4,2(1x,f6.2),1X,1A2,1X,1i5,
     *1X,1I1)
24	continue
	READ(2,*)ALAT,ALONG,IPEN
	if(ALAT.EQ.99.00) then
		ANLAT=ALAT
		ANLONG=ALONG
		go to 23
	  endif
	CALL ROTATE(ALAT,ALONG,ANLAT,ANLONG)
23	continue
	WRITE(4,1006)ANLAT,ANLONG,IPEN
	if(ALAT.ne.99.00) GO TO 24
	if(ALAT.eq.99.00) GO TO 22
1006	FORMAT(F9.4,1X,F9.4,1X,I2)
30	STOP
	END
	SUBROUTINE ROTATE  (ALAT,ALONG,ANLAT,ANLONG) 
        COMMON/BLOCK1/ROTLAT,ROTLO,ROTAN
	IF(ALAT.EQ.90.0) ALAT=89.999999 
	IF(ALAT.EQ.-90.0) ALAT=-89.999999 
	D=3.14159/180.0 
10	CONTINUE 
	A1=90.0*D-ALAT*D 
	SINA1=SIN(A1) 
	A2=ALONG*D 
	PX=SINA1*COS(A2) 
	PY=SINA1*SIN(A2) 
	PZ=COS(A1) 
	A3=90.0*D-ROTLAT*D 
	SINA3=SIN(A3) 
	A4=ROTAN*D 
	COSA4=COS(A4) 
	SINA4=SIN(A4) 
	A5=ROTLO*D 
	SINA5=SIN(A5) 
	COSA5=COS(A5) 
	GX=SINA3*COSA5 
	GY=SINA3*SINA5 
	GZ=COS(A3) 
	VCT=(PX*GX)+(PY*GY)+(PZ*GZ) 
	RX=COSA4*PX+(1.0-COSA4)*VCT*GX+ 
     1SINA4*(GY*PZ-GZ*PY) 
	RY=COSA4*PY+(1.0-COSA4)*VCT*GY+ 
     1SINA4*(GZ*PX-GX*PZ) 
	RZ=COSA4*PZ+(1.0-COSA4)*VCT*GZ+ 
     1SINA4*(GX*PY-GY*PX) 
C	IF(RZ.EQ.1.0) GO TO 20 
	IF(SQRT(1.0-RZ*RZ).EQ.0.0) GOTO 20 
	ASIN=ATAN(RZ/SQRT(1.0-RZ*RZ)) 
	ACOS=((3.14159/2.0-ASIN)*57.29578) 
	GO TO 30 
  20	CONTINUE 
	ACOS=0.0 
   30	ANLAT=90.0-ACOS 
	ANLONG=90.0-(ATAN2(RX,RY)*57.29578) 
	IF(ANLONG.GT.180.0) ANLONG=ANLONG-360.0 
999	CONTINUE 
C  999	TYPE 500 
C  500	FORMAT(' ALL DONE') 
	RETURN 
	END 
