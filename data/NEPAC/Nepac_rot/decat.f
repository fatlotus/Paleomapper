CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
CCCCCC 
CCCCCC		COPYRIGHT 1985,  ANN L. LOTTES
CCCCCC
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
CCCCCC
CCCCCC		PLEASE DIRECT ANY INQUIRIES REGARDING THIS SOFTWARE
CCCCCC		TO: 	ANN L. LOTTES
CCCCCC			DEPT. OF GEOPHYSICAL SCIENCES
CCCCCC			UNIVERSITY OF CHICAGO
CCCCCC			5734 SOUTH ELLIS AVE
CCCCCC			CHICAGO,  IL  60637
CCCCCC
	CHARACTER*80 NAME
	TYPE *, 'ROTATION POLE CONCATENATION'
	TYPE *, ' '
	TYPE *, 'THIS PROGRAM "UNCONCATENATES" POLES OF ROTATION'
	TYPE*, ' ENTER INPUT FILE NAME'
	READ(5,1)NAME
1	FORMAT(1A80)
	OPEN(UNIT=2,NAME=NAME,TYPE='OLD')
	TYPE*, ' ENTER OUTPUT FILE NAME'
	READ(5,1)NAME
	OPEN(UNIT=3,NAME=NAME)
10	CONTINUE
	READ(2,*,END=999)ID1,TIME,ALAT1,ALONG1,ANG1,ID2
	WRITE(3,2)ID1,TIME,ALAT1,ALONG1,ANG1,ID2
	ANG1=-ANG1
15	CONTINUE
	READ(2,*,END=999)ID1,TIME,ALAT2,ALONG2,ANG2,ID2
	IF ((ANG1.EQ.0.0).AND.(ANG2.EQ.0.0)) THEN
         ROTLAT=ALAT2
         ROTLO=ALONG2
         ROTAN=ANG2
           GO TO 17
         ENDIF
	IF ((ANG1.NE.0.0).AND.(ANG2.EQ.0.0)) THEN
         ROTLAT=ALAT2
         ROTLO=ALONG2
         ROTAN=ANG2
           GO TO 17
         ENDIF
	CALL ADDER(ALAT1,ALONG1,ANG1,ALAT2,ALONG2,ANG2,
     * ROTLAT,ROTLO,ROTAN)
17	WRITE(3,2)ID1,TIME,ROTLAT,ROTLO,ROTAN,ID2
2	FORMAT(1X,1I3,1X,1F8.3,3F10.3,1X,1I3)
	ALAT1=ALAT2
	ALONG1=ALONG2
	ANG1=-ANG2
	GO TO 15
999	CONTINUE
	close unit=2
	close unit=3
	STOP
	END
	subroutine adder(A1,P1,T1,A2,P2,T2,AMT,PHIT,THETT)
C     TAKEN FROM ROFN3
C     PROGRAM TO CALCULATE SUMS OF FINITE ROTATIONS.  GIVEN FIRST AND
C     SECOND ROTATIONS, PROGRAM WILL CALCULATE COMPOSITE ROTATION.
C     SCRIPPS INSTITUTE REFERENCE 70-30 JEAN FRANCHETEAU, PALEOMAGNETISM
C     AND PLATE TECTONICS.
C     PROGRAM BY LADD AUG 71. USED WITH PERMISSION.
C
C     POSITIVE ROTATION ANGLES ARE RELATED TO THEIR RESPECTIVE POLES BY
C     THE RIGHT HAND RULE WITH THUMB POINTING OUT OF SPHERE AT POLE.
C     ANGULAR ROTATION MUST BE LESS THAN 180 DEGREES.
C     INPUT LAT AND LONG OF ROTATION POLE PLUS ANGULAR ROTATION FOR FIRST
C     AND SECOND ROTATIONS.
C     CONVERT DEGREES TO RADIANS
C     PICK THE END OF THE ROTATION AXIS THAT WILL MAKE THE ROTATION ANGLE
C     POSITIVE AND LESS THAN 180. DEGREES.
	TYPE*, 'first pole   ',A1,P1,T1
	TYPE*, 'second pole   ', A2,P2,T2
    2 X=3.14159265358979
      CONST=X/180.
	IF(T1.EQ.0.0)THEN
		AMT=A2
		PHIT=P2
		THETT=T2
	  RETURN
	 END IF
	IF(T2.EQ.0.0)THEN
		AMT=A1
		PHIT=P1
		THETT=T1
	  RETURN
	 END IF
C	TYPE*, A1,P1,T1,A2,P2,T2
	IF((A1.EQ.A2).AND.(P1.EQ.P2))THEN
		AMT=A1
		PHIT=P1
		THETT=T2+T1
C	TYPE*, AMT,PHIT,THETT
	   RETURN
	   END IF	
C	IF((A2.EQ.A1).AND.(P2.EQ.P1))THEN
C	AMT=A1
C	PHIT=P1
C	THETT=T2-T1
C	TYPE*, AMT,PHIT,THETT
C	RETURN
C	END IF	
      AM1=A1*CONST
      PHI1=P1*CONST
      THET1=T1*CONST
      IF(THET1)21,22,22
   21 THET1=-THET1
      AM1=-AM1
      PHI1=PHI1+X
      GO TO 24
   22 IF(X-THET1)23,24,24
   23 THET1=2.*X-THET1
      AM1=-AM1
      PHI1=PHI1+X
   24 AM2=A2*CONST
      PHI2=P2*CONST
      THET2=T2*CONST
      IF(THET2)31,32,32
   31 THET2=-THET2
      AM2=-AM2
      PHI2=PHI2+X
      GO TO 34
   32 IF(X-THET2)33,34,34
   33 THET2=2.*X-THET2
      AM2=-AM2
      PHI2=PHI2+X
C
C     CALCULATE COLATITUDE
   34 AM1C=(X/2.)-AM1
      AM2C=(X/2.)-AM2
C
C     CALCULATE CAYLEY-KLEIN PARAMETERS
   40 OMEG1=COS(THET1/2.)
      XI1=SIN(THET1/2.)*SIN(AM1C)*COS(PHI1)
      ETA1=SIN(THET1/2.)*SIN(AM1C)*SIN(PHI1)
      ZETA1=SIN(THET1/2.)*COS(AM1C)
      OMEG2=COS(THET2/2.)
      XI2=SIN(THET2/2.)*SIN(AM2C)*COS(PHI2)
      ETA2=SIN(THET2/2.)*SIN(AM2C)*SIN(PHI2)
      ZETA2=SIN(THET2/2.)*COS(AM2C)
C
C     MATRIX ROTATION
      OMEGT=OMEG1*OMEG2-XI1*XI2-ETA1*ETA2-ZETA1*ZETA2
      XIT=OMEG1*XI2+XI1*OMEG2-ETA1*ZETA2+ZETA1*ETA2
      ETAT=OMEG1*ETA2+XI1*ZETA2+ETA1*OMEG2-ZETA1*XI2
      ZETAT=OMEG1*ZETA2-XI1*ETA2+ETA1*XI2+ZETA1*OMEG2
      IF(OMEGT)3,5,5
    3 OMEGT=-OMEGT
      XIT=-XIT
      ETAT=-ETAT
      ZETAT=-ZETAT
C
C     INVERT CAYLEY-KLEIN PARAMETERS OBTAINING COMPOSITE ROTATION.
    5 THETT=2.*ACOS(OMEGT)
      AMT=(X/2.)-ACOS(ZETAT/SIN(THETT/2.))
      PHIT=ATAN(ETAT/XIT)
      IF(XIT)41,52,52
   41 IF(ETAT)42,43,43
   42 PHIT=PHIT-X
      GO TO 52
   43 PHIT=PHIT+X
C
C     INVERT TO DEGREES
   52 CONST=180./X
      AMT=AMT*CONST
      THETT=THETT*CONST
      PHIT=PHIT*CONST
      IF(AMT)7,12,12
    7 AMT=-AMT
      THETT=-THETT
      IF(PHIT)8,8,9
    8 PHIT=PHIT+180.
      GO TO 12
    9 PHIT=PHIT-180.
C
   12 CONTINUE
	RETURN
	END
