CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
CCCCC	Program to read old formatPGAP and writes it out in new PGAP Format
cccc
	Program	oldtonewpgap  
	DIMENSION ALA(6),ALO(6),II(6)
	CHARACTER*80 NAME,NAM
	CHARACTER*5 ANOM	
	CHARACTER*3 REFNUM
	CHARACTER*5 LTYP
	CHARACTER*1 TCH
	CHARACTER*2 TYPE
	real*4 ALAT,ALONG
	D=1/57.29578
	ALA(1)=.05
	ALO(1)=.05
	II(1)=3
	ALA(2)=0.0
	ALO(2)=0.0
	II(2)=2
	ALA(3)=-.05
	ALO(3)=-.05
	II(3)=2
	ALA(4)=-.05
	ALO(4)=.05
	II(4)=3
	ALA(5)=0.0
	ALO(5)=0.0
	II(5)=2
	ALA(6)=.05
	ALO(6)=-.05
	II(6)=2
	REFNUM='999'
	TYPE='AN'
	T2=0.00
	INC=200
	ICOL=7
	ncnt=0
1	CONTINUE
	write(6,*) ' what file do you want to convert from'
	write(6,*) ' to new PGAP format?'
	read(5,1006) NAM
1006	FORMAT(1A80)
        OPEN(UNIT=4,NAME=NAM,TYPE='OLD',ERR=1)
2	CONTINUE
	write(6,*) ' what file do you want to CREATE?'
	read(5,1006) NAME
        OPEN(UNIT=3,NAME=NAME)
4       CONTINUE
	IPEN=3
	ncnt=ncnt+1
       READ(4,*,ERR=8,END=7)ID,TI1,ALAT,ALONG
C       write(6,*)ncnt,ID,TI1,ALAT,ALONG
CC1111	format(i3,1x,F6.2,1x,F6.3,1x,F7.3,1x,1A5)
	if(ncnt.eq.1) idtest=ID
	if(ncnt.eq.1) timetest=TI1
			CALL ANOMNAME  (TI1,LTYP)
			CALL ANOMAGE  (TI1,T1)
			CALL ANOMCOLOR (TI1,ICOL)  	
	if (ncnt.eq.1) then
		WRITE(6,1004)REFNUM,ncnt,ID,INC,T1,T2,TYPE,LTYP,ICOL
		WRITE(3,1004)REFNUM,ncnt,ID,INC,T1,T2,TYPE,LTYP,ICOL
	   endif
	if (idtest.ne.ID.or.TI1.ne.timetest) then
		BLAT=99.00
		BLON=0.00
		IPEN=3
		WRITE (3,1003)BLAT,BLON,IPEN
		WRITE(6,1004)REFNUM,ncnt,ID,INC,T1,T2,TYPE,LTYP,ICOL
		WRITE(3,1004)REFNUM,ncnt,ID,INC,T1,T2,TYPE,LTYP,ICOL
		idtest=ID
		timetest=TI1
	   endif
1004       FORMAT(1X,1A3,1I4,1X,1i3,1X,1I4,2(1x,f6.2),1X,1A2,1X,1A5,
     *1X,1I1)
	WRITE(3,1003)ALAT,ALONG,IPEN
	DO 21 I=1,6
        RLAT=ALAT+ALA(I)
        RLON=ALONG+ALO(I)
        NPEN=II(I)
	WRITE(3,1003)RLAT,RLON,NPEN
21	CONTINUE
        GOTO 4
1003	FORMAT (1F9.4,1x,F9.4,I3)
7	WRITE(6,*)'PROGRAM HAS ENDED'
	ALAT=99.00
	ALON=0.00
	IPEN=3
	WRITE (3,1003)ALAT,ALON,IPEN
	go to 9
8	write(6,*) 'error during read in line'
	write(6,1112) ncnt,ID,TI1,ALAT,ALONG,LTYP
9	CONTINUE
1112	format(i5,1x,i3,1x,F6.2,1x,F6.3,1x,F7.3,1x,1A5)
	close unit=3
	close unit=4
	STOP
	END	
	SUBROUTINE ANOMAGE (TI1,T1)
C	CHARACTER*5 LTYP
	IF(TI1.EQ.0.00)	T1=0.00
	IF(TI1.EQ.0.73)	T1=0.78
	IF(TI1.EQ.1.77)	T1=1.86
	IF(TI1.EQ.2.47)	T1=2.58
	IF(TI1.EQ.3.40)	T1=3.58
	IF(TI1.EQ.3.88)	T1=4.18
	IF(TI1.EQ.5.35)	T1=5.89
	IF(TI1.EQ.5.89)	T1=6.57
	IF(TI1.EQ.7.05)	T1=7.86
	IF(TI1.EQ.8.20)	T1=8.86
	IF(TI1.EQ.8.92)	T1=9.74
	IF(TI1.EQ.10.42)	T1=10.95
	IF(TI1.EQ.12.12)	T1=12.40
	IF(TI1.EQ.12.92)	T1=13.07
	IF(TI1.EQ.14.43)	T1=14.40
	IF(TI1.EQ.15.27)	T1=15.16
	IF(TI1.EQ.16.22)	T1=16.01
	IF(TI1.EQ.16.98)	T1=16.73
	IF(TI1.EQ.17.57)	T1=17.28
	IF(TI1.EQ.18.56)	T1=18.28
	IF(TI1.EQ.19.35)	T1=19.05
	IF(TI1.EQ.20.45)	T1=20.13
	IF(TI1.EQ.21.30)	T1=21.16
	IF(TI1.EQ.22.35)	T1=22.25
	IF(TI1.EQ.22.97)	T1=23.07
	IF(TI1.EQ.24.21)	T1=24.12
	IF(TI1.EQ.25.74)	T1=25.01
	IF(TI1.EQ.26.47)	T1=25.57
	IF(TI1.EQ.26.86)	T1=25.82
	IF(TI1.EQ.27.74)	T1=26.55
	IF(TI1.EQ.28.15)	T1=27.03
	IF(TI1.EQ.29.21)	T1=27.97
	IF(TI1.EQ.29.73)	T1=28.28
	IF(TI1.EQ.30.33)	T1=28.75
	IF(TI1.EQ.31.23)	T1=29.40
	IF(TI1.EQ.32.06)	T1=30.10
	IF(TI1.EQ.32.46)	T1=30.48
	IF(TI1.EQ.32.90)	T1=30.94
	IF(TI1.EQ.35.29)	T1=33.06
	IF(TI1.EQ.35.87)	T1=33.55
	IF(TI1.EQ.37.24)	T1=34.66
	IF(TI1.EQ.37.68)	T1=34.94
	IF(TI1.EQ.38.10)	T1=35.34
	IF(TI1.EQ.38.67)	T1=36.34
	IF(TI1.EQ.39.53)	T1=36.62
	IF(TI1.EQ.40.32)	T1=37.05
	IF(TI1.EQ.41.11)	T1=37.47
	IF(TI1.EQ.41.29)	T1=38.43
	IF(TI1.EQ.41.80)	T1=38.99
	IF(TI1.EQ.42.30)	T1=39.88
	IF(TI1.EQ.42.73)	T1=40.13
	IF(TI1.EQ.43.83)	T1=41.39
	IF(TI1.EQ.44.66)	T1=42.54
	IF(TI1.EQ.46.17)	T1=43.79
	IF(TI1.EQ.48.75)	T1=46.26
	IF(TI1.EQ.50.34)	T1=47.91
	IF(TI1.EQ.52.62)	T1=49.71
	IF(TI1.EQ.54.29)	T1=51.40
	IF(TI1.EQ.55.14)	T1=52.36
	IF(TI1.EQ.55.64)	T1=52.78
	IF(TI1.EQ.56.14)	T1=53.35
	IF(TI1.EQ.58.94)	T1=56.15
	IF(TI1.EQ.60.48)	T1=57.73
	IF(TI1.EQ.63.28)	T1=61.10
	IF(TI1.EQ.64.29)	T1=62.50
	IF(TI1.EQ.65.12)	T1=63.63
	IF(TI1.EQ.66.17)	T1=64.75
	IF(TI1.EQ.68.47)	T1=67.67
	IF(TI1.EQ.68.96)	T1=68.24
	IF(TI1.EQ.71.80)	T1=73.04
	IF(TI1.EQ.73.55)	T1=73.37
	IF(TI1.EQ.74.30)	T1=73.62
	IF(TI1.EQ.80.17)	T1=79.08
	IF(TI1.EQ.84.00)	T1=83.00
	IF(TI1.EQ.118.00)	T1=118.00
	IF(TI1.EQ.121.81)	T1=121.81
	IF(TI1.EQ.126.46)	T1=126.46
	RETURN
	END
	SUBROUTINE ANOMCOLOR(TI1,ICOL)
	IF(TI1.EQ.0.00)	ICOL=1
	IF(TI1.EQ.0.73)	ICOL=2
	IF(TI1.EQ.1.77)	ICOL=3
	IF(TI1.EQ.2.47)	ICOL=4
	IF(TI1.EQ.3.40)	ICOL=5
	IF(TI1.EQ.3.88)	ICOL=6
	IF(TI1.EQ.5.35)	ICOL=7
	IF(TI1.EQ.5.89)	ICOL=1
	IF(TI1.EQ.7.05)	ICOL=2
	IF(TI1.EQ.8.20)	ICOL=3
	IF(TI1.EQ.8.92)	ICOL=4
	IF(TI1.EQ.10.42)	ICOL=5
	IF(TI1.EQ.12.12)	ICOL=6
	IF(TI1.EQ.12.92)	ICOL=7
	IF(TI1.EQ.14.43)	ICOL=1
	IF(TI1.EQ.15.27)	ICOL=2
	IF(TI1.EQ.16.22)	ICOL=3
	IF(TI1.EQ.16.98)	ICOL=4
	IF(TI1.EQ.17.57)	ICOL=5
	IF(TI1.EQ.18.56)	ICOL=6
	IF(TI1.EQ.19.35)	ICOL=7
	IF(TI1.EQ.20.45)	ICOL=1
	IF(TI1.EQ.21.30)	ICOL=2
	IF(TI1.EQ.22.35)	ICOL=3
	IF(TI1.EQ.22.97)	ICOL=4
	IF(TI1.EQ.24.21)	ICOL=5
	IF(TI1.EQ.25.74)	ICOL=6
	IF(TI1.EQ.26.47)	ICOL=7
	IF(TI1.EQ.26.86)	ICOL=1
	IF(TI1.EQ.27.74)	ICOL=2
	IF(TI1.EQ.28.15)	ICOL=3
	IF(TI1.EQ.29.21)	ICOL=4
	IF(TI1.EQ.29.73)	ICOL=5
	IF(TI1.EQ.30.33)	ICOL=6
	IF(TI1.EQ.31.23)	ICOL=7
	IF(TI1.EQ.32.06)	ICOL=1
	IF(TI1.EQ.32.46)	ICOL=2
	IF(TI1.EQ.32.90)	ICOL=3
	IF(TI1.EQ.35.29)	ICOL=4
	IF(TI1.EQ.35.87)	ICOL=5
	IF(TI1.EQ.37.24)	ICOL=6
	IF(TI1.EQ.37.68)	ICOL=7
	IF(TI1.EQ.38.10)	ICOL=1
	IF(TI1.EQ.38.67)	ICOL=2
	IF(TI1.EQ.39.53)	ICOL=3
	IF(TI1.EQ.40.32)	ICOL=4
	IF(TI1.EQ.41.11)	ICOL=5
	IF(TI1.EQ.41.29)	ICOL=6
	IF(TI1.EQ.41.80)	ICOL=7
	IF(TI1.EQ.42.30)	ICOL=1
	IF(TI1.EQ.42.73)	ICOL=2
	IF(TI1.EQ.43.83)	ICOL=3
	IF(TI1.EQ.44.66)	ICOL=4
	IF(TI1.EQ.46.17)	ICOL=5
	IF(TI1.EQ.48.75)	ICOL=6
	IF(TI1.EQ.50.34)	ICOL=7
	IF(TI1.EQ.52.62)	ICOL=1
	IF(TI1.EQ.54.29)	ICOL=2
	IF(TI1.EQ.55.14)	ICOL=3
	IF(TI1.EQ.55.64)	ICOL=4
	IF(TI1.EQ.56.14)	ICOL=5
	IF(TI1.EQ.58.94)	ICOL=6
	IF(TI1.EQ.60.48)	ICOL=7
	IF(TI1.EQ.63.28)	ICOL=1
	IF(TI1.EQ.64.29)	ICOL=2
	IF(TI1.EQ.65.12)	ICOL=3
	IF(TI1.EQ.66.17)	ICOL=4
	IF(TI1.EQ.68.47)	ICOL=5
	IF(TI1.EQ.68.96)	ICOL=6
	IF(TI1.EQ.71.80)	ICOL=7
	IF(TI1.EQ.73.55)	ICOL=1
	IF(TI1.EQ.74.30)	ICOL=2
	IF(TI1.EQ.80.17)	ICOL=3
	IF(TI1.EQ.84.00)	ICOL=4
	IF(TI1.EQ.118.00)	ICOL=5
	IF(TI1.EQ.121.81)	ICOL=6
	IF(TI1.EQ.126.46)	ICOL=7
	RETURN
	END
	SUBROUTINE ANOMNAME (TI1,LTYP)
	CHARACTER*5 LTYP
	if(TI1.eq.0.0)  LTYP='1y'
	if(TI1.eq.0.73)  LTYP='1o'
	if(TI1.eq.1.77)  LTYP='2c'
	if(TI1.eq.2.47)  LTYP='2Ay'
	if(TI1.eq.3.4)  LTYP='2Ao'
	if(TI1.eq.3.88)  LTYP='3y'
	if(TI1.eq.4.77)  LTYP='3o'
	if(TI1.eq.5.35)  LTYP='3Ay'
	if(TI1.eq.5.89)  LTYP='3Ao'
	if(TI1.eq.7.05)  LTYP='4c'
	if(TI1.eq.8.2)  LTYP='4Ac'
	if(TI1.eq.8.92)  LTYP='5y'
	if(TI1.eq.10.42)  LTYP='5o'
	if(TI1.eq.12.12)  LTYP='5Ao'
	if(TI1.eq.12.92)  LTYP='5AAc'
	if(TI1.eq.14.43)  LTYP='5ADc'
	if(TI1.eq.15.27)  LTYP='5Bo'
	if(TI1.eq.16.22)  LTYP='5Cy'
	if(TI1.eq.16.98)  LTYP='5Co'
	if(TI1.eq.17.57)  LTYP='5Dy'
	if(TI1.eq.18.56)  LTYP='5Ey'
	if(TI1.eq.19.35)  LTYP='6y'
	if(TI1.eq.20.45)  LTYP='6o'
	if(TI1.eq.21.3)  LTYP='6Ac'
	if(TI1.eq.22.35)  LTYP='6AAo'
	if(TI1.eq.22.97)  LTYP='6Bo'
	if(TI1.eq.24.21)  LTYP='6Co'
	if(TI1.eq.25.74)  LTYP='7c'
	if(TI1.eq.26.47)  LTYP='7Ac'
	if(TI1.eq.26.86)  LTYP='8y'
	if(TI1.eq.27.74)  LTYP='8o'
	if(TI1.eq.28.15)  LTYP='9y'
	if(TI1.eq.29.21)  LTYP='9o'
	if(TI1.eq.29.73)  LTYP='10y'
	if(TI1.eq.30.33)  LTYP='10o'
	if(TI1.eq.31.23)  LTYP='11y'
	if(TI1.eq.32.06)  LTYP='11o'
	if(TI1.eq.32.46)  LTYP='12y'
	if(TI1.eq.32.9)  LTYP='12o'
	if(TI1.eq.35.29)  LTYP='13y'
	if(TI1.eq.35.87)  LTYP='13o'
	if(TI1.eq.37.24)  LTYP='15y'
	if(TI1.eq.37.68)  LTYP='15o'
	if(TI1.eq.38.1)  LTYP='16y'
	if(TI1.eq.38.67)  LTYP='16c'
	if(TI1.eq.39.24)  LTYP='16o'
	if(TI1.eq.39.53)  LTYP='17y'
	if(TI1.eq.40.32)  LTYP='17c'
	if(TI1.eq.41.11)  LTYP='17o'
	if(TI1.eq.41.29)  LTYP='18y'
	if(TI1.eq.41.8)  LTYP='18cy'
	if(TI1.eq.42.3)  LTYP='18co'
	if(TI1.eq.42.73)  LTYP='18o'
	if(TI1.eq.43.83)  LTYP='19c'
	if(TI1.eq.44.66)  LTYP='20y'
	if(TI1.eq.46.17)  LTYP='20o'
	if(TI1.eq.48.75)  LTYP='21y'
	if(TI1.eq.50.34)  LTYP='21o'
	if(TI1.eq.52.62)  LTYP='22o'
	if(TI1.eq.54.29)  LTYP='23c'
	if(TI1.eq.55.14)  LTYP='24y'
	if(TI1.eq.55.64)  LTYP='24c'
	if(TI1.eq.56.14)  LTYP='24o'
	if(TI1.eq.58.94)  LTYP='25c'
	if(TI1.eq.60.48)  LTYP='26c'
	if(TI1.eq.63.28)  LTYP='27c'
	if(TI1.eq.64.29)  LTYP='28y'
	if(TI1.eq.65.12)  LTYP='28o'
	if(TI1.eq.66.17)  LTYP='29o'
	if(TI1.eq.68.47)  LTYP='30Rc'
	if(TI1.eq.68.96)  LTYP='31c'
	if(TI1.eq.71.8)  LTYP='32Ao'
	if(TI1.eq.73.55)  LTYP='32o'
	if(TI1.eq.74.3)  LTYP='33y'
	if(TI1.eq.80.17)  LTYP='33o'
	if(TI1.eq.84.00)  LTYP='34y'
	if(TI1.eq.118.00)  LTYP='M0y'
	if(TI1.eq.121.81)  LTYP='M1y'
	if(TI1.eq.126.46)  LTYP='M5y'
	RETURN
	END
